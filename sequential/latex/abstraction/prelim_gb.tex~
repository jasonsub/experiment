\section{Computer Algebra Preliminaries}
\label{sec:ideals}

We review basic commutative algebra concepts related
to ideals, varieties, Nullstellensatz and Gr\"obner bases, and their 
application over Galois fields; the material is referred from
\cite{ideals:book} \cite{gb_book} and \cite{gao:gf-gb-ms}. 

Let $\mathbb{F}$ be a field and let $\mathbb{F}[x_1,\dots, x_d]$ be
the polynomial ring over $\mathbb{F}$ with indeterminates $x_1, \dots, 
x_d$. A {\it monomial} in variables $x_1, \cdots, x_d$ is a product of
the form $X = x_1^{\alpha_{1}}\cdot x_2^{\alpha_{2}}\cdots
x_d^{\alpha_{d}}$, where $\alpha_i \geq 0, i\in \{1, \dots, d\}$. A
{\it polynomial} $f \in \mathbb{F}[x_1,\dots, x_d], f\neq 0$, is 
written as a finite sum of terms $f = c_1 X_1 + c_2 X_2 + \dots + c_t
X_t$.  Here $c_1, \dots, c_t$ are coefficients and $X_1, \dots, X_t$
are monomials. To systematically manipulate the polynomials, a {\it
  monomial  ordering} $>$ is imposed such that $X_1 > X_2 > \dots >
X_t$. It is a  well-ordering on the set of all monomials such that
multiplication with a monomial preserves the
ordering\footnote{Lexicographic ({\it     lex}), degree-lexicographic
  ({\it deglex}), degree-reverse-lexicographic ({\it degrevlex}) are
  examples of monomial orderings.}. 
Subject to such an ordering, $lt(f) = c_1 X_1,  ~lm(f) = X_1, ~lc(f) =
c_1$, are the {\it leading   term}, {\it  leading monomial} and {\it
  leading coefficient} of $f$, respectively. Similarly, tail($f$) =
$c_2X_2 + \dots + c_t X_t$.

{\bf Polynomial reduction:} Let $f, g$ be polynomials. If a non-zero
term $cX$ of $f$ is divisible by the leading term of $g$, then we say
that $f$ {\it reduces} to $r$ modulo $g$, denoted $f
\stackrel{g}{\textstyle\longrightarrow} r$, where $r = f - {cX   \over
  lt(g)} \cdot g$. Similarly, $f$ can be reduced (divided) 
w.r.t. a set of polynomials  $F = \{f_1, \dots, f_s\}$ to obtain a
remainder $r$, denoted $f \stackrel{F} {\textstyle \longrightarrow}_+
r$, such that no term in $r$ is divisible by the leading term of any
polynomial in $F$.  

{\bf Ideals and varieties:} An {\it ideal} $J$ generated by
polynomials $f_1, \dots, f_s \in \mathbb{F}[x_1,\dots, x_d]$ is:
$$J = \langle f_1, \dots, f_s \rangle = \{\sum_{i=1}^{s}
h_i\cdot f_i: ~h_i \in \mathbb{F}[x_1,\dots,  x_d]\}.$$  The
polynomials $f_1, \dots, f_s$ form the basis or generators of
$J$. 

Let $\mathbf{a} = (a_1, \dots, a_d) \in \mathbb{F}^d$ be a point, and
$f \in \mathbb{F}[x_1,\dots, x_d]$ be a polynomial. We say that $f$
{\it vanishes} on $\mathbf{a}$ if $f(\mathbf{a}) = 0$. 

For any ideal $J = \langle f_1, \dots, f_s \rangle \subseteq
\mathbb{F}[x_1,\dots, x_d]$, the {\it affine variety} of $J$ over
$\mathbb{F}$ is:
$$V(J) = \{\mathbf{a} \in \mathbb{F}^d: \forall f \in
J, f(\mathbf{a}) = 0\}.$$ In other words, the variety corresponds to
the set of all solutions to $f_1 = \dots f_s = 0$. 
%If $J = \langle
%f_1, \dots, f_s \rangle = \langle g_1, \dots, g_t \rangle$, then $V(J)
%= V(f_1, \dots, f_s) = V(g_1, \dots, g_t)$. 

%%%% Florian says: I_{\mathbb{F}}(V)....


\begin{Definition}
For any subset $V$ of $\mathbb{F}^d$, the ideal of polynomials that
vanish on $V$, called the {\it vanishing ideal of $V$}, is defined as: 
$$I(V) = I_{\mathbb{F}}(V) = \{f\in \mathbb{F}[x_1,\dots, x_d]: \forall
\mathbf{a} \in V, f(\mathbf{a}) = 0\}.$$ 
\end{Definition}

\begin{Proposition}
\label{prop:finIV}
If a polynomial $f$ vanishes on a variety $V$, then $f \in I(V)$. 
\end{Proposition}


\vspace{-0.1in}
\subsection{Radicals and Nullstellensatz}
\begin{Definition}
\label{radical}
Let $J \subset \mathbb{F}[x_1,\dots, x_d]$ be an ideal. The {\it
  radical of $J$} is defined as $\sqrt{J} = \{f \in
\mathbb{F}[x_1,\dots, x_d]: \exists m \in \mathbb{N}, f^m \in
J\}$. 
\end{Definition}

When $J = \sqrt J$, then $J$ is said to be a {\it radical
  ideal}. Moreover, $I(V)$ is a radical ideal. The Strong 
Nullstellensatz establishes the correspondence between radical ideals 
and varieties.  

\begin{Theorem}
{\it Strong Nullstellensatz} \cite{gb_book}:  
Let $\mathbb{F}$ be an algebraically closed field, and let $J$
be an ideal in $\mathbb{F}[x_1,\dots, x_d]$. Then we have $I(V(J)) =
\sqrt{J}$. 
\end{Theorem}

We are concerned with Galois fields, which are not algebraically
closed. When a field $\mathbb{F}$ is not algebraically closed, then
the above result can be suitably applied over the algebraic closure of
$\mathbb{F}$.    

%%%% reinforce I_{\mathbb{F}}(---) 

\begin{Corollary}
\label{cor:nullsatz}
Let $\mathbb{F}$ be an arbitrary field and $J$ be an ideal in
$\mathbb{F}[x_1,\dots, x_d]$. Let $\overline{\mathbb{F}}$ denote the
algebraic closure of $\mathbb{F}$, and let
$V_{\overline{\mathbb{F}}}(J)$ denote the variety of $J$ over
$\overline{\mathbb{F}}$. Then $I_{\mathbb{F}}(V_{\overline{\mathbb{F}}}(J)) =
\sqrt{J}$.     
\end{Corollary}


\subsection{Strong Nullstellensatz over Galois Fields}

Nullstellensatz admits a special form over Galois fields. We state
the following results of Nullstellensatz over Galois fields, proofs of
which can be found in \cite{gao:gf-gb-ms}.  

\begin{Proposition}
Let ${\mathbb{F}}_q$ be a Galois field of $q$ elements. For all elements
$A \in \Fq$, we have $A^q - A = 0$. Therefore, for a polynomial $x^q -
x$, we have $V(x^q - x) = \Fq$.
\end{Proposition}

The polynomials of the form $\{x^q - x\}$ are called the {\it
  vanishing polynomials} of the field. Let $F_0 = \{x_1^q - x_1,
\dots, ~x_d^q - x_d\}$, then $J_0 = \langle x_1^q - x_1, \dots, x_d^q
- x_d\rangle$ is the ideal of all vanishing polynomials in
$\mathbb{F}_q[x_1,\dots,   x_d]$. Below, we use the concept of sum of
ideals: given ideals $I_1 = \langle f_1, \dots, f_s \rangle$ and $I_2
= \langle g_1, \dots, g_t \rangle$, then ideal $I_1 + I_2 = \langle
f_1, \dots, f_s, g_1, \dots, g_t\rangle$. 

\begin{Lemma}
\label{lemma:radical}
From \cite{gao:gf-gb-ms}: For any ideal $J \subseteq
\mathbb{F}_q[x_1,\dots, x_d]$, $J + J_0 = J + \langle x_1^q - x_1,
\dots, ~x_d^q - x_d\rangle$ is radical. In other words, $\sqrt{J +
  J_0} = J + J_0$. 
\end{Lemma}

The above is a very powerful result, as it implies that any ideal $J
\in \Fq[x_1, \dots, x_d]$ can be easily turned into a radical ideal by
adding $J_0$, without changing the zero-set $V(J)$ over $\Fq$. And,
based on the above, the following result can be easily deduced:

\begin{Theorem} %\cite{gao:gf-gb-ms}
\label{thm:strong-nullsatz-fq}
{\it Strong Nullstellensatz over $\Fq$:} For any Galois field $\Fq$,
let $J \subseteq \Fq[x_1,\dots,   x_d]$ be an ideal, and let 
$J_0 = \langle x_1^q - x_1, \dots, x_d^q - x_d\rangle$ be
the ideal of all vanishing polynomials. Let $V_{\Fq}(J)$ denote the
variety of $J$ over $\Fq$.  Then, $I(V_{\Fq}(J)) = J + J_0 = J +
\langle  x_1^q - x_1, \dots, ~x_d^q - x_d\rangle$.  
\end{Theorem}


\begin{proof}
Let $\overline{{\mathbb{F}}_q}$ denote the algebraic closure of
$\Fq$. Therefore, $\overline {\mathbb{F}_{q}} \supset
\mathbb{F}_{q}$, and we have:

\begin{eqnarray}
V_{\mathbb{F}_{q}}(J) &= & V_{\overline {\mathbb{F}_{q}}}(J) \cap \mathbb{F}_{q}^d  \nonumber \\
                   &= & V_{\overline {\mathbb{F}_{q}}}(J) \cap  V_{\mathbb{F}_{q}}(J_0)  \nonumber \\
                   &= & V_{\overline {\mathbb{F}_{q}}}(J) \cap
V_{\overline{\mathbb{F}_{q}}}(J_0) \nonumber  \\ 
                   &= & V_{\overline {\mathbb{F}_{q}}}(J+J_0) \nonumber
\end{eqnarray}

Therefore, $I(V_{\Fq}(J)) = I(V_{\overline
  {\mathbb{F}_{q}}}(J+J_0)) = \sqrt{J + J_0}$, from Corollary
\ref{cor:nullsatz}. Moreover, Lemma \ref{lemma:radical} says that $(J
+ J_0)$ is radical, so $\sqrt{J + J_0} = J + J_0$. Consequently, we
have that $I(V_{\Fq}(J)) = J + J_0$. 
\end{proof}



\subsection{Gr\"obner Basis of Ideals} 

An ideal $J$ may have many different generators: it is
possible to have sets of polynomials $F = \{f_1, \dots, f_s\}$ and $G
= \{g_1, \dots, g_t\}$ such that $J = \langle f_1, \dots, f_s \rangle
= \langle g_1, \dots, g_t\rangle$ and $V(J) = V(f_1, \dots, f_s) =
V(g_1, \dots, g_t)$.  Some generating sets are ``better''
than others, i.e. they are a better representation of the ideal. A
{\it Gr\"obner basis} is one such representation which allows to solve
many polynomial decision questions. 

\begin{Definition} \label{def:gb}
\debug{
$\bf{\left[Gr\ddot{o}bner\ Basis\right]}$ [From \cite{gb_book}] For
a monomial ordering $>$, a set  of non-zero polynomials $G =
\{g_1,g_2,\cdots,g_t\}$ contained in an ideal $J$, is called a
Gr\"{o}bner basis for $J$ $\iff$ 
$\forall f \in J$, $f\neq 0$, there exists $i \in \{1,\cdots, t\}$ such
that $lm(g_i)$ divides $lm(f)$; i.e., $G = GB(J)
\Leftrightarrow\  \forall f \in J : f \neq 0, \exists g_i \in G :
lm(g_i)\mid lm(f)$. 
}
\end{Definition}

In our context, Gr\"obner bases theory 
provides a {\it decision procedure to test for membership in an
ideal}. As a consequence of Definition \ref{def:gb}, the set $G$ is a
Gr\"obner basis of ideal $J$, if and only if for all $f \in J$,
dividing $f$ by polynomials of $G$ gives  0 remainder:  $G = GB(J)
\iff \forall f\in J, f \stackrel{G}{\textstyle\longrightarrow}_+ 0$. 

Buchberger's algorithm \cite{buchberger_thesis},
shown in Algorithm \ref{alg:gb},  computes a Gr\"obner
basis over a field. Given polynomials $F = \{f_1, \dots, f_s\}$, 
the algorithm computes the Gr\"obner basis $G = \{g_1, \dots, 
g_t\}$.
% such that ideal $I = \langle f_1, \dots, f_s\rangle = \langle g_1,
% \dots, g_t\rangle$. 
In the algorithm,  

\begin{equation}
       Spoly(f,g)=\frac{L}{lt(f)}\cdot f - \frac{L}{lt(g)}\cdot g \nonumber
      \label{eqn:spoly}
\end{equation}
where $L = \text{LCM}(lm(f), lm(g))$, where $lm(f)$ is the leading
monomial of $f$, and $lt(f)$ is the leading term of $f$. 


\begin{algorithm}[hbt]
\SetAlgoNoLine
 \KwIn{$F = \{f_1, \dots, f_s\}$}
 \KwOut{$G = \{g_1,\dots ,g_t\}$\\} %, a Gr\"{o}bner basis
  $G:= F$\;
  \Repeat{$G = G'$}
  {
  	$G' := G$\;
  	\For{ each pair $\{f, g\}, f \neq g$ in $G'$} 
	{
		$Spoly(f, g) \stackrel{G'}{\textstyle\longrightarrow}_+r$ \;
		\If{$r \neq 0$}
		{
			$G:= G \cup \{r\}$ \;
		}
	}
   }
\caption {Buchberger's Algorithm}\label{alg:gb}
\end{algorithm}

We now describe our verification problem formulation using Strong
Nullstellensatz over $\Fkk$, and its solution using Gr\"obner bases
and Buchberger's algorithm.

%% For Gr\"obner basis computation, a monomial (term) ordering is
%%   fixed to ensure that polynomials are manipulated in a consistent
%%   manner. 
%% %Conventionally, the lexicographic 
%% %(lex), degree-lexicographic (deg-lex) and degree-reverse-lexicographic
%% %(degrevlex) are used. 
%% Buchberger's algorithm then takes pairs of polynomials in the basis
%% and combines them into ``$S$-polynomials'' to cancel leading terms. An
%% $S$-polynomial is defined as: 
%% \begin{equation}
%%        S(f,g)=\frac{L}{lt(f)}\cdot f - \frac{L}{lt(g)}\cdot g
%%       \label{eqn:spoly}
%% \end{equation}
%% where $L = \text{LCM}(lm(f), lm(g))$, where $lm(f)$ is the leading
%% monomial of $f$, and $lt(f)$ denotes the leading term of $f$. The
%% $S$-polynomial is then reduced (divided) by all elements of $G'$ to a
%% remainder $r$, denoted as 
%% $S(f, g) \stackrel{G'}{\textstyle\longrightarrow}_+r$. 
%% Multivariate polynomial division is used for this reduction step. This
%% process is repeated for all unique pairs of polynomials, including
%% those created by newly added elements, until no new polynomials are
%% generated; ultimately constructing the Gr\"{o}bner basis.
